@page "/midfielders"
@inject ILogger<Midfielders> Logger 
@inject GetFplDataService fplService 
@using BlazTest.Components.Pages.Components
@rendermode InteractiveServer

<PageTitle>Midfielders</PageTitle>

<h1>Midfielders</h1>

<p>Showing players data</p>

<PlayerTable @ref="child" players="typedPlayers"></PlayerTable>

@code {
    public IEnumerable<Player>? typedPlayers { get; set; }

    PlayerTable? child; 

    protected override async Task OnInitializedAsync(){

        await fplService.taskCompletionSource.Task;

        typedPlayers = fplService.PlayerList.Where(p => p.Position == 3);
        
        await base.OnInitializedAsync();
    } 
    
    protected override async Task OnAfterRenderAsync(bool firstRender){
        
        if (firstRender)
        {
            //await JS.InvokeVoidAsync("sorttable.makeSortable", allTableRef);
            await child.SortTableInvokeJSAsync();
        }
        
        await base.OnAfterRenderAsync(firstRender);
    } 
}


